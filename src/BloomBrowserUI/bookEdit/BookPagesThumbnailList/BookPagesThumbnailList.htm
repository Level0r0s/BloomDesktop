<!DOCTYPE html>
<!-- including the lang attribute is causing css problems with settingsCollectionStyles.css -->
<!-- <html lang="en"> -->
<html>
<head>
    <meta charset="utf-8" />
    <link rel="stylesheet" type="text/css" href="bookEdit/editor/jquery.gridly.css" />
    <link rel="stylesheet" type="text/css" href="BookPagesThumbnailList.css" />
    <script src="/bloom/bookEdit/editor/jquery-2.0.3.js" type="text/javascript"></script>
    <script type="text/javascript" src="/bloom/bookEdit/editor/jquery.gridly.js"></script>
    <script type="text/javascript" src="/bloom/lib/errorHandler.js"></script>
    <script>
        var thumbnailTimerInterval = 200;
        var reorder = function (elements) {
            var ids = "";
            elements.each(function () {
                var id = $(this).attr('id');
                if (id)
                    ids += "," + id;
            });
            fireCSharpEvent("gridReordered", ids);
        };
        jQuery().ready(function () {
            $('.gridly').gridly({
                base: 35, // px
                gutter: 10, // px
                columns: 4, //Hack I discovered: if there is not room for 4 columns, this is replaced, at runtime, with 'columns: 2' by WebThumbNailList.cs
                callbacks: {
                    reordered: reorder
                }
            });
            jQuery('.gridItem').click(function () {
                fireCSharpEvent("gridClick", $(this).attr('id'));
            });

			// start the thumbnail timer
            var timerSetting = document.body.dataset['thumbnailInterval'];
            if (timerSetting)
                thumbnailTimerInterval = parseInt(timerSetting.value);

            // This timeout expires before the main page is displayed to the user, so we're using
            // thumbnailTimerInterval * 2 for the first interval to give the UI more time to catch up.
            setTimeout(loadNextThumbnail, thumbnailTimerInterval * 2);
        });
        function fireCSharpEvent(eventName, eventData) {

            var event = new MessageEvent(eventName, { 'view': window, 'bubbles': true, 'cancelable': true, 'data': eventData });
            document.dispatchEvent(event);
        }

        function loadNextThumbnail() {

            /* bizarrely, the translate moves it to the top left instead of the middle of the original space.
            // of the "src" attribute is copied into it and then the "src" attribute is set to an empty string so the
                If you fiddle with these, the formula for the translate percent is 100*(1-scale)/2/scale. */
            transform: scale(0.075) translate(617%,-617%); /* Default scaling is A5 Portrait */


            if ((!nextImg) || (nextImg.length === 0)) return;

            text-align:right;

        }
        div.gridItem:nth-child(even) div.thumbnailCaption {
            text-align: left;
        }

            pointer-events: none;
            // images were requested before the server had finished processing previous images requests. We are also
        .gridSelected .pageContainer { /* Default scaling is A5 Portrait */
            // 2015-06-04: The interval is now a variable rather than a constant in order to make the initial Edit tab
            border: 3px solid rgb(255, 255, 163);/*matches the current tooltip yellow*/
            height: 60px;
    </script>
    <title></title>
	  <link rel="stylesheet" type="text/css" href="/bloom/bookEdit/BookPagesThumbnailList/BookPagesThumbnailList.css"/>
</head>
<body id="body">
<div class="gridly">
        <!-- //Hack I discovered:  if there is not room for 4 columns, this is replaced, at runtime, with "" -->
    <div class="gridItem placeholder" id="placeholder"></div>
</div>
</body>
</html>